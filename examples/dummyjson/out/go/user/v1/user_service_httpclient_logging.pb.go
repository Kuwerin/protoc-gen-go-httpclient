//	Code generated by protoc-gen-httpclient. DO NOT EDIT.
//	versions:
// 	protoc-gen-go v1.28.0
// 	protoc        v3.19.0

package userapi

import (
	"context"
	"time"

	"github.com/go-kit/log"
)

type loggingMiddleware struct {
	logger log.Logger

	next UserServiceServer

	UnimplementedUserServiceServer
}

func LoggingMiddleware(logger log.Logger) func(UserServiceServer) UserServiceServer {
	return func(next UserServiceServer) UserServiceServer {
		return &loggingMiddleware{
			logger: logger,
			next:   next,
		}
	}
}

// Gets a user.
func (mw *loggingMiddleware) GetUser(ctx context.Context, in *GetUserRequest) (res *User, err error) {
	defer func(begin time.Time) {
		mw.logger.Log(
			"package", "dummyjson.user.v1.user_service",
			"method", "get_user",
			"id", in.GetId(),
			"error", err,
			"took", time.Since(begin),
		)
	}(time.Now())

	return mw.next.GetUser(ctx, in)
}

// Lists users.
func (mw *loggingMiddleware) ListUsers(ctx context.Context, in *ListUsersRequest) (res *ListUsersResponse, err error) {
	defer func(begin time.Time) {
		mw.logger.Log(
			"package", "dummyjson.user.v1.user_service",
			"method", "list_users",
			"limit", in.Limit, "skip", in.Skip,
			"error", err,
			"took", time.Since(begin),
		)
	}(time.Now())

	return mw.next.ListUsers(ctx, in)
}
